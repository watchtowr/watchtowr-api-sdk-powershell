#
# Complete watchTowr Platform API Documentation
# The watchTowr Client API combining all watchTowr Platform APIs into a single comprehensive reference, including:       * Automated Red Teaming API       * Adversary Sight API       * Intelligence API       * Platform API 
# Version: 1.0
# Contact: support@watchTowr.io
# Generated by OpenAPI Generator: https://openapi-generator.tech
#

<#
.SYNOPSIS

No summary available.

.DESCRIPTION

No description available.

.PARAMETER Name
Rule name
.PARAMETER Type
Rule type
.PARAMETER KeywordMatcher
Keyword for matching domains/subdomains (required when type is keyword)
.PARAMETER CountryCode
Geographical location 2-letter country code (ISO 3166-1 alpha-2) for matching IPs (required when type is country). Examples: SG, US, GB, AU
.PARAMETER IntegrationType
Integration type for matching cloud assets (required when type is integration). Valid values: aws, azure, googlecloud, cloudflare, alibabacloud, prismacloud, prismacloudapigee, huaweicloud, tencentcloud, wiz, servicenowcmdb, akamaiedge, armiscentrix, qualysvmdr, tenable
.PARAMETER IntegrationId
Integration ID for matching cloud assets (required when type is integration)
.PARAMETER CascadeSubdomain
Whether to cascade rule to subdomains
.PARAMETER CascadeIp
Whether to cascade rule to IPs
.PARAMETER IncludeAllIntegrations
Whether to include all integrations
.OUTPUTS

CreateClientBusinessUnitRuleDto<PSCustomObject>
#>

function Initialize-CreateClientBusinessUnitRuleDto {
    [CmdletBinding()]
    Param (
        [Parameter(Position = 0, ValueFromPipelineByPropertyName = $true)]
        [String]
        ${Name},
        [Parameter(Position = 1, ValueFromPipelineByPropertyName = $true)]
        [ValidateSet("keyword", "country", "integration")]
        [String]
        ${Type},
        [Parameter(Position = 2, ValueFromPipelineByPropertyName = $true)]
        [String]
        ${KeywordMatcher},
        [Parameter(Position = 3, ValueFromPipelineByPropertyName = $true)]
        [String]
        ${CountryCode},
        [Parameter(Position = 4, ValueFromPipelineByPropertyName = $true)]
        [ValidateSet("aws", "azure", "googlecloud", "cloudflare", "alibabacloud", "prismacloud", "prismacloudapigee", "huaweicloud", "tencentcloud", "wiz", "servicenowcmdb", "akamaiedge", "armiscentrix", "qualysvmdr", "tenable")]
        [String]
        ${IntegrationType},
        [Parameter(Position = 5, ValueFromPipelineByPropertyName = $true)]
        [System.Nullable[Decimal]]
        ${IntegrationId},
        [Parameter(Position = 6, ValueFromPipelineByPropertyName = $true)]
        [System.Nullable[Boolean]]
        ${CascadeSubdomain} = $true,
        [Parameter(Position = 7, ValueFromPipelineByPropertyName = $true)]
        [System.Nullable[Boolean]]
        ${CascadeIp} = $true,
        [Parameter(Position = 8, ValueFromPipelineByPropertyName = $true)]
        [System.Nullable[Boolean]]
        ${IncludeAllIntegrations} = $false
    )

    Process {
        'Creating PSCustomObject: WatchtowrAPI => CreateClientBusinessUnitRuleDto' | Write-Debug
        $PSBoundParameters | Out-DebugParameter | Write-Debug

        if ($null -eq $Name) {
            throw "invalid value for 'Name', 'Name' cannot be null."
        }

        if ($null -eq $Type) {
            throw "invalid value for 'Type', 'Type' cannot be null."
        }


        $PSO = [PSCustomObject]@{
            "name" = ${Name}
            "type" = ${Type}
            "keyword_matcher" = ${KeywordMatcher}
            "country_code" = ${CountryCode}
            "integration_type" = ${IntegrationType}
            "integration_id" = ${IntegrationId}
            "cascade_subdomain" = ${CascadeSubdomain}
            "cascade_ip" = ${CascadeIp}
            "include_all_integrations" = ${IncludeAllIntegrations}
        }


        return $PSO
    }
}

<#
.SYNOPSIS

Convert from JSON to CreateClientBusinessUnitRuleDto<PSCustomObject>

.DESCRIPTION

Convert from JSON to CreateClientBusinessUnitRuleDto<PSCustomObject>

.PARAMETER Json

Json object

.OUTPUTS

CreateClientBusinessUnitRuleDto<PSCustomObject>
#>
function ConvertFrom-JsonToCreateClientBusinessUnitRuleDto {
    Param(
        [AllowEmptyString()]
        [string]$Json
    )

    Process {
        'Converting JSON to PSCustomObject: WatchtowrAPI => CreateClientBusinessUnitRuleDto' | Write-Debug
        $PSBoundParameters | Out-DebugParameter | Write-Debug

        $JsonParameters = ConvertFrom-Json -InputObject $Json

        # check if Json contains properties not defined in CreateClientBusinessUnitRuleDto
        $AllProperties = ("name", "type", "keyword_matcher", "country_code", "integration_type", "integration_id", "cascade_subdomain", "cascade_ip", "include_all_integrations")
        foreach ($name in $JsonParameters.PsObject.Properties.Name) {
            if (!($AllProperties.Contains($name))) {
                throw "Error! JSON key '$name' not found in the properties: $($AllProperties)"
            }
        }

        If ([string]::IsNullOrEmpty($Json) -or $Json -eq "{}") { # empty json
            throw "Error! Empty JSON cannot be serialized due to the required property 'name' missing."
        }

        if (!([bool]($JsonParameters.PSobject.Properties.name -match "name"))) {
            throw "Error! JSON cannot be serialized due to the required property 'name' missing."
        } else {
            $Name = $JsonParameters.PSobject.Properties["name"].value
        }

        if (!([bool]($JsonParameters.PSobject.Properties.name -match "type"))) {
            throw "Error! JSON cannot be serialized due to the required property 'type' missing."
        } else {
            $Type = $JsonParameters.PSobject.Properties["type"].value
        }

        if (!([bool]($JsonParameters.PSobject.Properties.name -match "keyword_matcher"))) { #optional property not found
            $KeywordMatcher = $null
        } else {
            $KeywordMatcher = $JsonParameters.PSobject.Properties["keyword_matcher"].value
        }

        if (!([bool]($JsonParameters.PSobject.Properties.name -match "country_code"))) { #optional property not found
            $CountryCode = $null
        } else {
            $CountryCode = $JsonParameters.PSobject.Properties["country_code"].value
        }

        if (!([bool]($JsonParameters.PSobject.Properties.name -match "integration_type"))) { #optional property not found
            $IntegrationType = $null
        } else {
            $IntegrationType = $JsonParameters.PSobject.Properties["integration_type"].value
        }

        if (!([bool]($JsonParameters.PSobject.Properties.name -match "integration_id"))) { #optional property not found
            $IntegrationId = $null
        } else {
            $IntegrationId = $JsonParameters.PSobject.Properties["integration_id"].value
        }

        if (!([bool]($JsonParameters.PSobject.Properties.name -match "cascade_subdomain"))) { #optional property not found
            $CascadeSubdomain = $null
        } else {
            $CascadeSubdomain = $JsonParameters.PSobject.Properties["cascade_subdomain"].value
        }

        if (!([bool]($JsonParameters.PSobject.Properties.name -match "cascade_ip"))) { #optional property not found
            $CascadeIp = $null
        } else {
            $CascadeIp = $JsonParameters.PSobject.Properties["cascade_ip"].value
        }

        if (!([bool]($JsonParameters.PSobject.Properties.name -match "include_all_integrations"))) { #optional property not found
            $IncludeAllIntegrations = $null
        } else {
            $IncludeAllIntegrations = $JsonParameters.PSobject.Properties["include_all_integrations"].value
        }

        $PSO = [PSCustomObject]@{
            "name" = ${Name}
            "type" = ${Type}
            "keyword_matcher" = ${KeywordMatcher}
            "country_code" = ${CountryCode}
            "integration_type" = ${IntegrationType}
            "integration_id" = ${IntegrationId}
            "cascade_subdomain" = ${CascadeSubdomain}
            "cascade_ip" = ${CascadeIp}
            "include_all_integrations" = ${IncludeAllIntegrations}
        }

        return $PSO
    }

}

